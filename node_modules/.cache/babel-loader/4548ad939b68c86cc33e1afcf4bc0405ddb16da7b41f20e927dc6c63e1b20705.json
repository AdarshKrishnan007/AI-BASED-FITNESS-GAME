{"ast":null,"code":"import apiFetch from \"./api\";\nfunction base64ToBlob(base64, mimeType = \"video/mp4\") {\n  const byteString = atob(base64); // ✅ no .split\n  const ab = new ArrayBuffer(byteString.length);\n  const ia = new Uint8Array(ab);\n  for (let i = 0; i < byteString.length; i++) {\n    ia[i] = byteString.charCodeAt(i);\n  }\n  return new Blob([ab], {\n    type: mimeType\n  });\n}\nconst workoutService = {\n  startLiveDetection: exercise => {\n    const user_id = localStorage.getItem(\"email\");\n    if (!user_id) throw new Error(\"User not logged in or missing user_id\");\n    return apiFetch(\"/start\", {\n      method: \"POST\",\n      body: {\n        user_id,\n        type: exercise\n      }\n    });\n  },\n  uploadVideoDetection: (base64String, exercise) => {\n    const formData = new FormData();\n\n    // Convert base64 string to Blob\n    const blob = base64ToBlob(base64String);\n    const file = new File([blob], \"workout.mp4\", {\n      type: \"video/mp4\"\n    });\n    formData.append(\"video\", file);\n    formData.append(\"exercise\", exercise);\n    return apiFetch(\"/upload\", {\n      method: \"POST\",\n      body: formData,\n      isForm: true\n    });\n  },\n  logWorkout: data => apiFetch(\"/workout/log\", {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: data\n  }),\n  getTodayProgress: () => {\n    const user_id = localStorage.getItem(\"email\");\n    return apiFetch(\"/workout/progress\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: {\n        user_id\n      }\n    });\n  },\n  unlockNextLevel: ({\n    user_id,\n    currentLevel\n  }) => {\n    return apiFetch(\"/workout/unlock-level\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: {\n        user_id,\n        currentLevel\n      }\n    });\n  }\n};\nexport default workoutService;","map":{"version":3,"names":["apiFetch","base64ToBlob","base64","mimeType","byteString","atob","ab","ArrayBuffer","length","ia","Uint8Array","i","charCodeAt","Blob","type","workoutService","startLiveDetection","exercise","user_id","localStorage","getItem","Error","method","body","uploadVideoDetection","base64String","formData","FormData","blob","file","File","append","isForm","logWorkout","data","headers","getTodayProgress","unlockNextLevel","currentLevel"],"sources":["D:/Fitness WebApp/client/src/services/workoutService.js"],"sourcesContent":["import apiFetch from \"./api\";\r\n\r\nfunction base64ToBlob(base64, mimeType = \"video/mp4\") {\r\n  const byteString = atob(base64); // ✅ no .split\r\n  const ab = new ArrayBuffer(byteString.length);\r\n  const ia = new Uint8Array(ab);\r\n\r\n  for (let i = 0; i < byteString.length; i++) {\r\n    ia[i] = byteString.charCodeAt(i);\r\n  }\r\n\r\n  return new Blob([ab], { type: mimeType });\r\n}\r\n\r\nconst workoutService = {\r\n  startLiveDetection: (exercise) => {\r\n    const user_id = localStorage.getItem(\"email\");\r\n    if (!user_id) throw new Error(\"User not logged in or missing user_id\");\r\n\r\n    return apiFetch(\"/start\", {\r\n      method: \"POST\",\r\n      body: {\r\n        user_id,\r\n        type: exercise,\r\n      },\r\n    });\r\n  },\r\n\r\n  uploadVideoDetection: (base64String, exercise) => {\r\n    const formData = new FormData();\r\n\r\n    // Convert base64 string to Blob\r\n    const blob = base64ToBlob(base64String);\r\n    const file = new File([blob], \"workout.mp4\", { type: \"video/mp4\" });\r\n\r\n    formData.append(\"video\", file);\r\n    formData.append(\"exercise\", exercise);\r\n\r\n    return apiFetch(\"/upload\", {\r\n      method: \"POST\",\r\n      body: formData,\r\n      isForm: true,\r\n    });\r\n  },\r\n\r\n  logWorkout: (data) =>\r\n    apiFetch(\"/workout/log\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: data,\r\n    }),\r\n\r\n  getTodayProgress: () => {\r\n    const user_id = localStorage.getItem(\"email\");\r\n    return apiFetch(\"/workout/progress\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: { user_id },\r\n    });\r\n  },\r\n  unlockNextLevel: ({ user_id, currentLevel }) => {\r\n    return apiFetch(\"/workout/unlock-level\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: { user_id, currentLevel },\r\n    });\r\n  },\r\n};\r\n\r\nexport default workoutService;\r\n"],"mappings":"AAAA,OAAOA,QAAQ,MAAM,OAAO;AAE5B,SAASC,YAAYA,CAACC,MAAM,EAAEC,QAAQ,GAAG,WAAW,EAAE;EACpD,MAAMC,UAAU,GAAGC,IAAI,CAACH,MAAM,CAAC,CAAC,CAAC;EACjC,MAAMI,EAAE,GAAG,IAAIC,WAAW,CAACH,UAAU,CAACI,MAAM,CAAC;EAC7C,MAAMC,EAAE,GAAG,IAAIC,UAAU,CAACJ,EAAE,CAAC;EAE7B,KAAK,IAAIK,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGP,UAAU,CAACI,MAAM,EAAEG,CAAC,EAAE,EAAE;IAC1CF,EAAE,CAACE,CAAC,CAAC,GAAGP,UAAU,CAACQ,UAAU,CAACD,CAAC,CAAC;EAClC;EAEA,OAAO,IAAIE,IAAI,CAAC,CAACP,EAAE,CAAC,EAAE;IAAEQ,IAAI,EAAEX;EAAS,CAAC,CAAC;AAC3C;AAEA,MAAMY,cAAc,GAAG;EACrBC,kBAAkB,EAAGC,QAAQ,IAAK;IAChC,MAAMC,OAAO,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;IAC7C,IAAI,CAACF,OAAO,EAAE,MAAM,IAAIG,KAAK,CAAC,uCAAuC,CAAC;IAEtE,OAAOrB,QAAQ,CAAC,QAAQ,EAAE;MACxBsB,MAAM,EAAE,MAAM;MACdC,IAAI,EAAE;QACJL,OAAO;QACPJ,IAAI,EAAEG;MACR;IACF,CAAC,CAAC;EACJ,CAAC;EAEDO,oBAAoB,EAAEA,CAACC,YAAY,EAAER,QAAQ,KAAK;IAChD,MAAMS,QAAQ,GAAG,IAAIC,QAAQ,CAAC,CAAC;;IAE/B;IACA,MAAMC,IAAI,GAAG3B,YAAY,CAACwB,YAAY,CAAC;IACvC,MAAMI,IAAI,GAAG,IAAIC,IAAI,CAAC,CAACF,IAAI,CAAC,EAAE,aAAa,EAAE;MAAEd,IAAI,EAAE;IAAY,CAAC,CAAC;IAEnEY,QAAQ,CAACK,MAAM,CAAC,OAAO,EAAEF,IAAI,CAAC;IAC9BH,QAAQ,CAACK,MAAM,CAAC,UAAU,EAAEd,QAAQ,CAAC;IAErC,OAAOjB,QAAQ,CAAC,SAAS,EAAE;MACzBsB,MAAM,EAAE,MAAM;MACdC,IAAI,EAAEG,QAAQ;MACdM,MAAM,EAAE;IACV,CAAC,CAAC;EACJ,CAAC;EAEDC,UAAU,EAAGC,IAAI,IACflC,QAAQ,CAAC,cAAc,EAAE;IACvBsB,MAAM,EAAE,MAAM;IACda,OAAO,EAAE;MACP,cAAc,EAAE;IAClB,CAAC;IACDZ,IAAI,EAAEW;EACR,CAAC,CAAC;EAEJE,gBAAgB,EAAEA,CAAA,KAAM;IACtB,MAAMlB,OAAO,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;IAC7C,OAAOpB,QAAQ,CAAC,mBAAmB,EAAE;MACnCsB,MAAM,EAAE,MAAM;MACda,OAAO,EAAE;QACP,cAAc,EAAE;MAClB,CAAC;MACDZ,IAAI,EAAE;QAAEL;MAAQ;IAClB,CAAC,CAAC;EACJ,CAAC;EACDmB,eAAe,EAAEA,CAAC;IAAEnB,OAAO;IAAEoB;EAAa,CAAC,KAAK;IAC9C,OAAOtC,QAAQ,CAAC,uBAAuB,EAAE;MACvCsB,MAAM,EAAE,MAAM;MACda,OAAO,EAAE;QACP,cAAc,EAAE;MAClB,CAAC;MACDZ,IAAI,EAAE;QAAEL,OAAO;QAAEoB;MAAa;IAChC,CAAC,CAAC;EACJ;AACF,CAAC;AAED,eAAevB,cAAc","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}